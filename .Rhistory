O
sink()
sink()
sink()
sink()
O
lopm.CalibSet
sink()
sink()
lopm.CalibSet
?WPS
?WSP
library(lme4)
library(splines)
exp(1.96)
exp(-1.96)
dt<-data_frame(m=sqrt(exp(1)),sd=sqrt((exp(1)-1)*exp(1)))
exp(1.96)
dt<-data_frame(e=exp(1),m=sqrt(e),sd=sqrt((e-1)*e)
)
dt<-data_frame(e=exp(1),m=sqrt(e),sd=sqrt((e-1)*e))
exp(-1.96)
dt<-data_frame(e=exp(1),m=sqrt(e),sd=sqrt((e-1)*e))
)exp(1.96)
exp(1.96)
exp(1.96*2)
exp(z)
exp(1.96)
exp(1.96)*2
exp(1.96)^2
exp(1.96)
data<-dt
exp(1)-1
sqrt(exp(1)-1)
19/sqrt(1.310832^2+1)
log(19/sqrt(1.310832^2+1))
log(19.29/sqrt(1.310832^2+1))
1+1.310832^2
log(1+1.310832^2)
log(19.29728)
log(19.29728)-1
exp(1.96-1)
exp(1.96)
exp(1.96+1)
exp(-1.96+1)
ggMap(var=rate,data=crude.rate,color= "YlOrRd",legend=list(title="Hosp. rate\nfor 100 000"))
ggMap(var=rate,data=crude.rate,color= "YlOrRd",legend=list(title="Hosp. rate\nfor 100 000"))
var="rate"
title
legend
names(ggplot_build(p))
names(ggplot_build(p)$layout)
?annotation_custom
     df <- data.frame(x = 1:10, y = 1:10)
     base <- ggplot(df, aes(x, y)) +
       geom_blank() +
       theme_bw()
     
     # Full panel annotation
     base + annotation_custom(
       grob = grid::roundrectGrob(),
       xmin = -Inf, xmax = Inf, ymin = -Inf, ymax = Inf
     )

limits
limits=NULL
qplot(1:10)
p
p+theme(panel.border = theme_blank())
p+theme(panel.border = elemnt_blank())
p+theme(panel.border = element_blank())
SIR.compare
SIR.compare%>%arrange(SIR)%>%mutate(id=row_number()-0.2+0.2*method=="glmer")
SIR.compare%>%arrange(SIR)%>%mutate(id=row_number()-0.2+0.2*(method=="glmer"))
SIR.compare%>%arrange(SIR)%>%mutate(id=row_number()-0.5*(method=="glmer"))
SIR.compare%>%arrange(SIR)%>%group_by(method)%>%mutate(id=row_number()-0.5*(method=="glmer"))
SIR.compare%>%arrange(SIR)%>%group_by(method)%>%mutate(id=row_number()-0.2*(method=="glmer"))
SIR.compare%>%arrange(SIR)%>%group_by(method)%>%mutate(id=row_number()-0.2*(method=="glmer"))%>%qplot(data=.,id,SIR)
SIR.compare%>%arrange(SIR)%>%group_by(method)%>%mutate(id=row_number()-0.2*(method=="glmer"))%>%qplot(data=.,id,SIR,colour=method)
SIR.compare%>%arrange(SIR)%>%group_by(method)%>%mutate(id=row_number()-0.2*(method=="glmer"))%>%qplot(data=.,id,SIR,colour=method)
SIR.compare%>%arrange(SIR)%>%group_by(method)%>%mutate(id=row_number()-0.4*(method=="glmer"))%>%qplot(data=.,id,SIR,colour=method)
SIR.compare%>%arrange(SIR)%>%group_by(method)%>%mutate(id=row_number()-0.4*(method=="glmer"))%>%qplot(data=.,id,SIR,colour=method)+geom_pointrange(aes(ymin=low,ymax=up))
SIR.compare
SIR.compare%>%mutate(cv=se/pred)%>%select(dist,cv,method)%>%spread(method,cv)
SIR.compare%>%mutate(cv=se/pred)%>%select(dist,cv,method)%>%spread(method,cv)%>%qplot(data=.,100*(glmer-glmmPQL)/glmmPQL)
SIR.compare%>%mutate(cv=se/pred)%>%select(dist,cv,method)%>%spread(method,cv)%>%qplot(data=.,100*(glmer-glmmPQL)/glmer)
SIR.compare%>%arrange(SIR)%>%group_by(method)%>%mutate(id=row_number()-0.4*(method=="glmer"))%>%qplot(data=.,id,SIR,colour=method)+geom_pointrange(aes(ymin=low,ymax=up))
SIR.compare%>%mutate(cv=se)%>%select(dist,cv,method)%>%spread(method,cv)%>%qplot(data=.,100*(glmer-glmmPQL)/glmer)
SIR.compare%>%mutate(cv=se.SIR)%>%select(dist,cv,method)%>%spread(method,cv)%>%qplot(data=.,100*(glmer-glmmPQL)/glmer)
SIR.compare%>%arrange(SIR)%>%group_by(method)%>%mutate(id=row_number()-0.4*(method=="glmer"))%>%qplot(data=.,id,SIR,colour=method)+geom_pointrange(aes(ymin=low,ymax=up))
SIR.compare%>%mutate(cv=se.SIR)%>%select(dist,cv,method)%>%spread(method,cv)%>%mutate(diff=100*(glmer-glmmPQL)/glmer)%>%arrange(diff)
SIR.compare%>%mutate(cv=se.SIR)%>%select(dist,cv,method)%>%spread(method,cv)%>%mutate(diff=100*(glmer-glmmPQL)/glmer)%>%arrange(desc(diff))
(0.10019839-0.08985484)/0.08985484
(0.10019839-0.08985484)
SIR.compare%>%mutate(cv=low)%>%select(dist,cv,method)%>%spread(method,cv)%>%mutate(diff=100*(glmer-glmmPQL)/glmer)%>%arrange(desc(diff))
SIR.compare%>%mutate(cv=low)%>%select(dist,cv,method)%>%spread(method,cv)%>%qplot(data=.,100*(glmer-glmmPQL)/glmer)
SIR.compare%>%mutate(cv=up)%>%select(dist,cv,method)%>%spread(method,cv)%>%qplot(data=.,100*(glmer-glmmPQL)/glmer)
SIR.compare%>%mutate(cv=up)%>%select(dist,cv,method)%>%spread(method,cv)%>%qplot(data=.,100*(glmer-glmmPQL)/glmer)
SIR.compare%>%arrange(SIR)%>%group_by(method)%>%mutate(id=row_number()-0.4*(method=="glmer"))%>%qplot(data=.,id,SIR,colour=method)+geom_pointrange(aes(ymin=low,ymax=up))
glm
 mod=mod.calib
ag<-~toto+dist
any
?any
all.vars(nobars(formula(mod)))
CalibInc(mod.calib,pred=lopm.Fr%>%select(age)%>%unique%>%mutate(H=1),aggregate=~age)
CalibInc(mod.calib,aggregate=~dist)
CalibInc(mod.calib,aggregate=~age)
CalibInc(mod.calib,aggregate=~age+dist)
CalibInc(mod.calib,aggregate=~dist)%>%arrange(dist)
